document.addEventListener("DOMContentLoaded",()=>{let a=new Audio(),b=document.getElementById("canvas"),c=b.getContext("2d"),d=document.getElementById("play"),e=document.getElementById("next"),f=document.getElementById("prev"),g=document.getElementById("trackName"),h=document.getElementById("videoPlayer"),i=document.getElementById("muteVideoBtn"),j=document.querySelectorAll(".taskbar-btn"),k=document.getElementById("volumeSlider"),l=document.getElementById("taskbar-time"),m,n,o,p=[],q=0,r=Math.floor(Math.random()*28)+1,s=function(t,u){let v=!1,w,x;u.addEventListener("mousedown",e=>{if(getComputedStyle(t).display==="none")return;if(t.style.width==="0px"||t.style.height==="0px"||t.style.opacity==="0"){t.style.width=t.dataset.defaultWidth||"320px";t.style.height=t.dataset.defaultHeight||"auto";t.style.opacity="1"}v=!0;w=e.clientX-t.offsetLeft;x=e.clientY-t.offsetTop;e.preventDefault();t.style.zIndex=100});document.addEventListener("mouseup",()=>{v=!1});document.addEventListener("mousemove",e=>{if(v){let y=e.clientX-w,z=e.clientY-x,A=window.innerWidth,B=window.innerHeight,C=t.getBoundingClientRect();y<0&&(y=0);y+C.width>A&&(y=A-C.width);z<0&&(z=0);z+C.height>B&&(z=B-C.height);t.style.left=y+"px";t.style.top=z+"px";t.style.bottom="auto";t.style.right="auto"}})},u=function(t,u,v,w,x){if(!t.dataset.defaultWidth)t.dataset.defaultWidth=x.width;if(!t.dataset.defaultHeight)t.dataset.defaultHeight=x.height;u&&(u.onclick=()=>{t.style.width="0px";t.style.height="0px";t.style.opacity="0"});w&&(w.onclick=()=>t.style.display="none");v&&(v.onclick=()=>{const y=t.style.width==="100vw";y||(t.style.width="100vw",t.style.height="100vh",t.style.top="0",t.style.left="0",t.style.right="0",t.style.bottom="0",t.style.transform="none",t.style.opacity="1");y&&(Object.assign(t.style,x),t.style.opacity="1",t.style.bottom="auto",t.style.right="auto")})};j.forEach(t=>{t.addEventListener("click",()=>{let u=document.getElementById(t.dataset.window);if(!u)return;getComputedStyle(u).display==="none"||u.style.display==="none"?(u.style.display="block",u.style.zIndex=100,(u.style.width==="0px"||u.style.height==="0px"||u.style.opacity==="0")&&(u.style.width=u.dataset.defaultWidth||"320px",u.style.height=u.dataset.defaultHeight||"auto",u.style.opacity="1")):u.style.display="none"})});k.value=a.volume;k.addEventListener("input",()=>{a.volume=k.value});fetch("playlist.json").then(t=>t.json()).then(t=>{p=function(t){for(let u=t.length-1;u>0;u--){let v=Math.floor(Math.random()*(u+1));[t[u],t[v]]=[t[v],t[u]]}return t}(t);z(0)});function z(t){if(!p.length)return;q=((t%p.length)+p.length)%p.length;a.src=p[q].src;g.textContent="Track: "+p[q].name}d.onclick=()=>{y();aCtx.resume();a.paused?(a.play().catch(console.error),d.textContent="⏸"):(a.pause(),d.textContent="▶️")};e.onclick=()=>{z(q+1);a.play().catch(console.error);d.textContent="⏸"};f.onclick=()=>{z(q-1);a.play().catch(console.error);d.textContent="⏸"};a.onended=()=>e.click();let aCtx,aa,ab;function y(){if(aCtx)return;aCtx=new(window.AudioContext||window.webkitAudioContext)();ab=aCtx.createMediaElementSource(a);ab.connect(aCtx.destination)}function ac(){y();aa=aCtx.createAnalyser();ab.connect(aa);aa.connect(aCtx.destination);aa.fftSize=256;let t=aa.frequencyBinCount,u=new Uint8Array(t);function v(){requestAnimationFrame(v);aa.getByteFrequencyData(u);b.width=b.clientWidth;b.height=b.clientHeight;c.fillStyle="#000";c.fillRect(0,0,b.width,b.height);let w=0;for(let x=0;x<t;x++){let y=u[x];c.fillStyle=`rgb(${y+25},${(250*x)/t},50)`;c.fillRect(w,b.height-y,w*0+2.5,y);w+=w*0+3.5}}v()}a.addEventListener("play",()=>{aa||ac()});s(document.getElementById("playerWindow"),document.getElementById("titleBar"));s(document.getElementById("profileWindow"),document.getElementById("profileTitleBar"));s(document.getElementById("videoWindow"),document.getElementById("videoTitleBar"));u(document.getElementById("playerWindow"),document.getElementById("btnMinimize"),document.getElementById("btnMaximize"),document.getElementById("btnClose"),{width:"320px",height:"auto",top:"0",left:"unset",right:"0",transform:"none"});u(document.getElementById("profileWindow"),document.getElementById("profileMinimize"),document.getElementById("profileMaximize"),document.getElementById("profileClose"),{width:"400px",height:"auto",top:"50%",left:"50%",transform:"translate(-50%,-50%)"});u(document.getElementById("videoWindow"),null,null,document.getElementById("videoCloseBtn"),{width:"360px",height:"auto",top:"0",left:"0",transform:"none"});let ad=function(t){r=((t-1+28)%28)+1;h.src=`video/clip (${r}).mp4`;h.load();h.play().catch(console.warn)};ad(r);document.getElementById("nextClip").onclick=()=>ad(r+1);document.getElementById("prevClip").onclick=()=>ad(r-1);i.onclick=()=>{h.muted=!h.muted;i.textContent=h.muted?"🔇":"🔊"};let ae=document.getElementById("overlay");ae.addEventListener("click",()=>{d.click();ae.classList.add("hidden");setTimeout(()=>ae.remove(),800)});z(0);navigateTo("https://yenny.lol")});fetch('https://thatsadoublewhammy-rapid-band-4f2e.mrwalkemdowntohellhawktuah.workers.dev/').then(t=>t.text()).then(t=>console.log('Worker Response:',t)).catch(t=>console.error('Error fetching from worker:',t));
